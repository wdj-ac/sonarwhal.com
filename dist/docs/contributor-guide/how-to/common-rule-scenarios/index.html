<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Implement common rule scenarios | sonarwhal documentation</title> <meta property="og:image" content="/static/images/apple-touch-icon-c01d89d4f3.png"><meta property="og:description" content="sonarwhal, a linting tool for the web focused on best practices and flexibility for the end user"><meta property="og:title" content="Implement common rule scenarios"><meta name="description" content="sonarwhal, a linting tool for the web focused on best practices and flexibility for the end user"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#4046dd"><link rel="manifest" href="/static/site-b1a71cb190.webmanifest"><link rel="apple-touch-icon" href="/static/images/apple-touch-icon-c01d89d4f3.png"><link type="application/opensearchdescription+xml" rel="search" href="/static/opensearch-eaec25f991.xml" title="sonarwhal"><link rel="icon" href="/static/images/favicon-dd9d5dff4e.ico"> <link rel="stylesheet" href="/static/styles/common-f0d599dc94.css" integrity="sha384-FrUPgIHFNLSd41g3b26WzegsfNG/Yz4Qp63Xemf2nMMv1XrfbYJU9Dn81AMrYj2u" crossorigin="anonymous"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,500" integrity="sha384-6hCj8YZdGj+SQ9wB8ShBR1XRd+tUsQSfKu1i4C72EaUKO6AeEipi63+OPsdZPLoD" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" integrity="sha384-mHx5KeR3zcLviQFPmpHqrwf2uxtukRvUFVzOMOqIjKjSNrurxlmJ3oS+vm49Mz07" crossorigin="anonymous"><link rel="stylesheet" href="/static/styles/docs-aea1404a6b.css" integrity="sha384-Joq3wpwZ1GpeoibnNAx67vRhmwjvkm2yZ5Nq3L3n/XdiPFHORf/yu0GxMEbztADd" crossorigin="anonymous"></head><body><header class="header"><div class="header-social"><div class="header-social__container container"><img src="/static/images/jsf_logo_white-a73061e34d.svg" alt="A JS Foundation Project"><ul class="header-social__list"><li class="github-icon"><a href="https://github.com/sonarwhal" aria-label="Follow sonarwhal on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 25 25"><path class="github-icon-svg-header" d="M12.5.4C5.7.4.2 5.9.2 12.7c0 5.4 3.5 10 8.4 11.7.6.1.8-.3.8-.6v-2.1C6 22.4 5.3 20 5.3 20c-.6-1.4-1.4-1.8-1.4-1.8-1.1-.7.1-.7.1-.7 1.2.1 1.9 1.3 1.9 1.3 1.1 1.9 2.9 1.3 3.6 1 .1-.8.4-1.3.8-1.6-2.7-.3-5.6-1.4-5.6-6.1 0-1.3.5-2.4 1.3-3.3-.2-.4-.6-1.6 0-3.3 0 0 1-.3 3.4 1.3 1-.3 2-.4 3.1-.4 1 0 2.1.1 3.1.4C17.9 5.2 19 5.5 19 5.5c.7 1.7.2 2.9.1 3.3.8.9 1.3 2 1.3 3.3 0 4.7-2.9 5.8-5.6 6.1.4.4.8 1.1.8 2.3v3.4c0 .3.2.7.8.6 4.9-1.6 8.4-6.2 8.4-11.7C24.8 5.9 19.3.4 12.5.4"/></svg></a></li><li class="twitter-icon"><a href="https://twitter.com/narwhalnellie" aria-label="Follow sonarwhal on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 25 24"><path class="twitter-icon-svg-header" d="M25 4.4c-.9.4-1.9.7-2.9.8 1-.6 1.8-1.6 2.2-2.8-1 .6-2.1 1-3.2 1.2-.9-1-2.2-1.6-3.7-1.6-2.8 0-5 2.3-5 5 0 .4 0 .8.1 1.2C8.3 8 4.6 6 2.1 2.9c-.4.8-.7 1.6-.7 2.6 0 1.8.9 3.3 2.2 4.2-.8-.1-1.5-.3-2.2-.7v.1c0 2.4 1.7 4.5 4.1 5-.4.1-.9.2-1.3.2-.3 0-.6 0-.9-.1.6 2 2.5 3.5 4.7 3.5-1.9 1.3-4 2.1-6.4 2.1-.4 0-.8 0-1.2-.1C2.6 21.2 5.3 22 8.1 22c9.3 0 14.4-7.7 14.4-14.4v-.7c1-.6 1.8-1.5 2.5-2.5"/></svg></a></li><li class="medium-icon"><a href="https://medium.com/sonarwhal" aria-label="Follow sonarwhal on Medium"><svg xmlns="http://www.w3.org/2000/svg" viewbox="4 2 40 40"><path class="medium-icon-svg-header" d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.7-.32 1.03l-2.45 3v.38h6.9v-.4l-2.4-2.98c-.3-.34-.35-.5-.35-1.03v-8.95l6.13 13.36h.7L27 18.42v10.64c0 .3 0 .35-.2.53L25 31.4v.37h9.2v-.4l-1.82-1.8c-.2-.17-.22-.23-.22-.52v-13.1c0-.3.03-.36.2-.54l1.83-1.8v-.32h-6.5L23.1 24.8l-5.2-11.55h-6.8v.4l2.14 2.63c.24.3.3.37.3.77V27.4z"/></svg></a></li></ul></div></div><div class="nav-bar container"><nav class="nav"><a href="/" class="clear logo--container"><img src="/static/images/sonar-logo-4fa31d71a3.svg" alt="sonarwhal" class="header__logo navbar__navitem"></a><ul class="nav__navbar"><li class="navbar__navitem"><a role="button" href="/scanner/" id="scanner" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-scanner" class="navitem__button ">Scanner</a> </li><li class="navbar__navitem"><a role="button" href="/docs/" id="docs" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-docs" class="navitem__button expandable">Documentation</a> <ul role="group" id="submenu-docs" class="navbar__submenu" aria-hidden="true"><li><a href="/docs/contributor-guide/">Contributor Guide</a></li><li><a href="/docs/user-guide/rules/">Rules</a></li><li><a href="/docs/user-guide/">User Guide</a></li></ul></li><li class="navbar__navitem"><a role="button" href="/about/" id="about" aria-haspopup="true" aria-expanded="false" aria-controls="submenu-about" class="navitem__button expandable">About</a> <ul role="group" id="submenu-about" class="navbar__submenu" aria-hidden="true"><li><a href="/about/faq/">FAQ</a></li><li><a href="/about/changelog/">Changelog</a></li><li><a href="/about/governance/">Governance</a></li><li><a href="https://js.foundation/community/code-of-conduct">Code of Conduct</a></li></ul></li></ul><div class="nav-bar--container"><div class="nav-bar__input"><form action="/search" method="GET"><label for="search-input" class="visually-hidden">Search the documentation</label><input type="search" id="search-input" placeholder="Search Documentation" name="q" aria-label="Search"> <button type="submit" aria-label="search" class="button-search"></button></form></div><button class="mobile-close-button" aria-label="Close Search Overlay">Close</button></div><div class="nav-bar--mobile-buttons"><button class="header__toggle mobile-nav-button" aria-label="Menu"></button> <button class="header__toggle mobile-search-button" aria-label="Search"></button></div></nav></div></header><main class="container">  <article class="content" aria-labelledby="page-heading"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/">Home</a></li><li><a href="../../../">Documentation</a></li><li><a href="../../" class="guide-category">Contributor guide</a></li><li aria-current="location">Implement common rule scenarios</li></ul></nav><header class="page-intro"><h1 id="page-heading">Implement common rule scenarios</h1><div class="documentation-actions"><ul><li><a target="_blank" href="https://github.com/sonarwhal/sonarwhal/edit/master/packages/sonarwhal/docs/contributor-guide/how-to/common-rule-scenarios.md">Edit</a></li><li><a target="_blank" href="https://github.com/sonarwhal/sonarwhal/issues/new?title=%5Bdocs%5D%20Issue%20with%20&apos;Implement%20common%20rule%20scenarios&apos;&amp;body=https%3A%2F%2Fsonarwhal.com%2Fdocs%2Fcontributor-guide%2Fhow-to%2Fcommon-rule-scenarios%2Findex.html">Signal Issue</a></li></ul></div></header><div class="section" id="main"><div class="layout layout--sidebar"><div class="module module--secondary mobile-view"><ul class="toc-mobile-view"><li><p role="button" id="mobile-toc" aria-controls="mobile-toc-submenu" aria-expanded="false" aria-haspopup="true" class="toc-mobile-view__button expandable">Contributor guide</p><ul role="group" class="toc-mobile-view__dropdown" id="mobile-toc-submenu" aria-hidden="true"><li class="dropdown__subitem"><a href="../../" class="subitem--single">Getting Started</a></li> <li class="dropdown__subitem"><p>getting started</p><ul><li class="subitem"><a href="/docs/contributor-guide/getting-started/architecture/">Architecture</a></li><li class="subitem"><a href="/docs/contributor-guide/getting-started/development-environment/">Development environment</a></li><li class="subitem"><a href="/docs/contributor-guide/getting-started/events/">Events</a></li><li class="subitem"><a href="/docs/contributor-guide/getting-started/pull-requests/">Pull requests</a></li></ul></li><li class="dropdown__subitem"><p>guides</p><ul><li class="subitem"><a href="/docs/contributor-guide/guides/create-custom-rule/">Create a custom rule step-by-step</a></li></ul></li><li class="dropdown__subitem"><p>how to</p><ul><li class="subitem"><a href="/docs/contributor-guide/how-to/connector/">Develop a connector</a></li><li class="subitem"><a href="/docs/contributor-guide/how-to/formatter/">Develop a formatter</a></li><li class="subitem"><a href="/docs/contributor-guide/how-to/parser/">Develop a parser</a></li><li class="subitem"><a href="/docs/contributor-guide/how-to/rule/">Develop a rule</a></li><li class="subitem"><a href="/docs/contributor-guide/how-to/common-rule-scenarios/">Implement common rule scenarios</a></li><li class="subitem"><a href="/docs/contributor-guide/how-to/test-rules/">Test a rule</a></li></ul></li></ul></li></ul></div><div class="module module--secondary table-of-contents treeview main-view" role="navigation"><ul role="tree" aria-labelledby="page-heading" tabindex="0"><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="false"><div class=" toc-section-title "><span class="text">getting started</span> <span class="icon"></span></div><ul role="group"><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/getting-started/architecture/" tabindex="-1">Architecture</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/getting-started/development-environment/" tabindex="-1">Development environment</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/getting-started/events/" tabindex="-1">Events</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/getting-started/pull-requests/" tabindex="-1">Pull requests</a></div></li></ul></li><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="false"><div class=" toc-section-title "><span class="text">guides</span> <span class="icon"></span></div><ul role="group"><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/guides/create-custom-rule/" tabindex="-1">Create a custom rule step-by-step</a></div></li></ul></li><li role="treeitem" aria-label="subsection" tabindex="0" aria-expanded="true"><div class=" toc-section-title--active "><span class="text">how to</span> <span class="icon"></span></div><ul role="group"><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/how-to/connector/" tabindex="0">Develop a connector</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/how-to/formatter/" tabindex="0">Develop a formatter</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/how-to/parser/" tabindex="0">Develop a parser</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/how-to/rule/" tabindex="0">Develop a rule</a></div></li><li role="treeitem" aria-selected="true"><div class=" toc-subsection-title--active " aria-current="location"><a class="text" href="/docs/contributor-guide/how-to/common-rule-scenarios/" tabindex="0">Implement common rule scenarios</a></div></li><li role="treeitem" aria-selected="false"><div class=" toc-subsection-title " aria-current=""><a class="text" href="/docs/contributor-guide/how-to/test-rules/" tabindex="0">Test a rule</a></div></li></ul></li></ul></div><div class="module module--primary wrap-text"> <h1 id="implement-common-rule-scenarios">Implement common rule scenarios<a href="#implement-common-rule-scenarios" class="headerlink" title="Implement common rule scenarios"></a></h1><p>This page documents the most common scenarios encoutered when developing a rule
for <code>sonarwhal</code>. If there&#x2019;s something that you want to do that is not
documented here, please <a href="https://github.com/sonarwhal/sonarwhal/issues/new" target="_blank" rel="nofollow noreferrer noopener">open an issue</a> so we can help you.</p>
<h2 id="change-feedback-based-on-browser-support">Change feedback based on browser support<a href="#change-feedback-based-on-browser-support" class="headerlink" title="Change feedback based on browser support"></a></h2><p>Users can tell <code>sonarwhal</code> what browsers are important for them via a
<a href="../../user-guide/index.md#browserconfiguration"><code>browserslist</code> property added in <code>.sonarwhalrc</code></a> or in
the <code>package.json</code> file. Rules can access this list (and modify their feedback)
via the property <code>content.targetedBrowsers</code>.</p>
<p>You can have access to the list, and thus modify
the feedback of your rule, via the property <code>context.targetedBrowsers</code>.</p>
<!-- eslint-disable no-unused-vars -->
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> validate = <span class="function">(<span class="params">fetchEnd</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">if</span> (!context.targetedBrowsers.includes(<span class="string">&apos;Edge 14&apos;</span>)) {</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your validations</span></span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h2 id="reporting-an-error-if-not-run">Reporting an error if not run<a href="#reporting-an-error-if-not-run" class="headerlink" title="Reporting an error if not run"></a></h2><p>Sometimes what a rule checks is mandatory, and if it does not have
the chance to test it, it should fail. These are the types of rules
that enforce certain things to be used in a certain way, and if
included, in order for the rule to pass, the expectation should be
that the thing the rule checks for should exist and be valid/used
correctly.</p>
<p>For example, there could be a rule that checks that a particular
JavaScript file is loaded (an analytics library). If it isn&#x2019;t, it
should fail.</p>
<p>The recommended way to implement a rule like this is to subscribe
to the event <code>scan::end</code>. If the rule receives that event and has
not run any validation it should report an issue.</p>
<h2 id="evaluate-javascript-in-the-page-context">Evaluate JavaScript in the page context<a href="#evaluate-javascript-in-the-page-context" class="headerlink" title="Evaluate JavaScript in the page context"></a></h2><p>Sometimes a rule needs to evaluate some JavaScript in the context of
the page. To do that you need to use <code>context.evaluate</code>. This method
will always return a <code>Promise</code> even if your code does not return one.</p>
<p>One important thing is that your code needs to be wrapped in an
immediate invoked function expression (IIFE).</p>
<p>The following scripts will work:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> script =</span><br><span class="line"><span class="string">`(function() {</span></span><br><span class="line"><span class="string">    return true;</span></span><br><span class="line"><span class="string">}())`</span>;</span><br><span class="line"></span><br><span class="line">context.evaluate(script);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> script =</span><br><span class="line"><span class="string">`(function() {</span></span><br><span class="line"><span class="string">    return Promise.resolve(true);</span></span><br><span class="line"><span class="string">}())`</span>;</span><br><span class="line"></span><br><span class="line">context.evaluate(script);</span><br></pre></td></tr></table></figure>
<p>The following does not:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> script = <span class="string">`return true;`</span>;</span><br><span class="line"></span><br><span class="line">context.evaluate(script);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> script = <span class="string">`return Promise.resolve(true);`</span>;</span><br><span class="line"></span><br><span class="line">context.evaluate(script);</span><br></pre></td></tr></table></figure>
<h2 id="ignore-connectors">Ignore connectors<a href="#ignore-connectors" class="headerlink" title="Ignore connectors"></a></h2><p>If your rule does not work properly with certain connectors you can
use the property <code>ignoreConnectors</code> so it is not run when they are used.</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> MyRule <span class="keyword">implements</span> IRule {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly meta: RuleMetadata = {</span><br><span class="line">        id: <span class="string">&apos;my-rule&apos;</span>,</span><br><span class="line">        ignoredConnectors: [<span class="string">&apos;jsdom&apos;</span>]</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">context: RuleContext</span>) {</span><br><span class="line">        <span class="comment">// Your code here</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="interact-with-other-services">Interact with other services<a href="#interact-with-other-services" class="headerlink" title="Interact with other services"></a></h2><p>You can develop a rule that integrates with other services. <code>sonarwhal</code>
integrates with a few such as <code>ssllabs</code>.</p>
<p>Because these online tools usually take a few seconds to return the
results the guidance is to start the analysis as soon as possible
and then collect the results as late as possible. This means you
will have to listen to <code>scan::start</code> and <code>scan::end</code> events respectively.
The <code>create</code> method of your rule should be similar to the following:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> MyRule <span class="keyword">implements</span> IRule {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly meta: RuleMetadata = {</span><br><span class="line">        id: <span class="string">&apos;my-rule&apos;</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">context: RuleContext</span>) {</span><br><span class="line">        <span class="comment">/** The promise that represents the connection to the online service. */</span></span><br><span class="line">        <span class="keyword">let</span> promise: <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> start = <span class="function">(<span class="params">data: ScanStartEvent</span>) =&gt;</span> {</span><br><span class="line">            <span class="comment">// Initialize promise to service here but do not return it.</span></span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> end = (data: ScanEndEvent): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; =&gt; {</span><br><span class="line">            <span class="keyword">return</span> promise</span><br><span class="line">                .then(<span class="function">(<span class="params">results</span>) =&gt;</span> {</span><br><span class="line">                    <span class="comment">// Report any results via `context.report` here.</span></span><br><span class="line">                })</span><br><span class="line">                .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> {</span><br><span class="line">                    <span class="comment">// Always good to handle errors.</span></span><br><span class="line">                });</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line">        context.on(<span class="string">&apos;scan::start&apos;</span>, start);</span><br><span class="line">        context.on(<span class="string">&apos;scan::end&apos;</span>, end);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>In case you need a more complete example, please look at the
<a href="https://github.com/sonarwhal/sonarwhal/blob/master/packages/rule-ssllabs/src/rule.ts" target="_blank" rel="nofollow noreferrer noopener"><code>ssllabs.ts</code> source code</a>.</p>
<h2 id="validate-javascript">Validate JavaScript<a href="#validate-javascript" class="headerlink" title="Validate JavaScript"></a></h2><p>To create a rule that understands JavaScript you will need to use the
event <code>parse::javascript</code> emitted by the <a href="../../user-guide/concepts/parser.md"><code>javascript parser</code></a>.
This event is of type <code>IScriptParse</code> which has the following information:</p>
<ul>
<li><code>resource</code>: the parsed resource. If the JavaScript is in a <code>&lt;script&gt; tag</code>
and not a file, the value will be <code>Internal javascript</code>.</li>
<li><code>sourceCode</code>: a <code>eslint</code> <code>SourceCode</code> object.</li>
</ul>
<p>Here is an example rule that use the parser:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> eslint <span class="keyword">from</span> <span class="string">&apos;eslint&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> ScriptSemiColonRule <span class="keyword">implements</span> IRule {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly meta: RuleMetadata = {</span><br><span class="line">        docs: {</span><br><span class="line">            category: Category.interoperability,</span><br><span class="line">            description: <span class="string">`Check if your scripts use semicolon`</span></span><br><span class="line">        },</span><br><span class="line">        id: <span class="string">&apos;script-semicolon&apos;</span>,</span><br><span class="line">        recommended: <span class="literal">false</span>,</span><br><span class="line">        schema: [],</span><br><span class="line">        worksWithLocalFiles: <span class="literal">true</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">constructor</span>(<span class="params">context: RuleContext</span>) {</span><br><span class="line">        <span class="keyword">let</span> validPromise;</span><br><span class="line">        <span class="keyword">const</span> errorsOnly = context.ruleOptions &amp;&amp; context.ruleOptions[<span class="string">&apos;errors-only&apos;</span>] || <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">let</span> html;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> onParseJavascript = <span class="keyword">async</span> (scriptParse: ScriptParse) =&gt; {</span><br><span class="line">            <span class="keyword">const</span> results = linter.verify(scriptParse.sourceCode, {</span><br><span class="line">                rules: {</span><br><span class="line">                    semi: <span class="number">2</span></span><br><span class="line">                }</span><br><span class="line">            });</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> result of results) {</span><br><span class="line">                <span class="keyword">await</span> context.report(scriptParse.resource, <span class="literal">null</span>, result.message);</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line"></span><br><span class="line">        context.on(<span class="string">&apos;parse::javascript&apos;</span>, onParseJavascript);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>And when writing tests, you need to specify the parsers that you need:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">ruleRunner.testRule(ruleName, tests, {</span><br><span class="line">    parsers: [<span class="string">&apos;javascript&apos;</span>]</span><br><span class="line">});</span><br></pre></td></tr></table></figure>
<!-- Link labels: -->
 </div></div><a href="#main" class="anchor-top" hidden aria-label="back to top">top</a></div></article>  </main><footer class="footer footer--home"><div class="footer-nav container"><div class="footer-nav__item"><p class="category"><a href="/scanner/">Scanner</a></p><ul></ul></div><div class="footer-nav__item"><p class="category"><a href="/docs/">Documentation</a></p><ul><li><a href="/docs/contributor-guide/">Contributor Guide</a></li><li><a href="/docs/user-guide/rules/">Rules</a></li><li><a href="/docs/user-guide/">User Guide</a></li></ul></div><div class="footer-nav__item"><p class="category"><a href="/about/">About</a></p><ul><li><a href="/about/faq/">FAQ</a></li><li><a href="/about/changelog/">Changelog</a></li><li><a href="/about/governance/">Governance</a></li><li><a href="https://js.foundation/community/code-of-conduct">Code of Conduct</a></li></ul></div><ul class="footer-nav__item social-list"><li class="github-icon"><a href="https://github.com/sonarwhal" aria-label="Follow sonarwhal on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 25 25"><path class="github-icon-svg" d="M12.5.4C5.7.4.2 5.9.2 12.7c0 5.4 3.5 10 8.4 11.7.6.1.8-.3.8-.6v-2.1C6 22.4 5.3 20 5.3 20c-.6-1.4-1.4-1.8-1.4-1.8-1.1-.7.1-.7.1-.7 1.2.1 1.9 1.3 1.9 1.3 1.1 1.9 2.9 1.3 3.6 1 .1-.8.4-1.3.8-1.6-2.7-.3-5.6-1.4-5.6-6.1 0-1.3.5-2.4 1.3-3.3-.2-.4-.6-1.6 0-3.3 0 0 1-.3 3.4 1.3 1-.3 2-.4 3.1-.4 1 0 2.1.1 3.1.4C17.9 5.2 19 5.5 19 5.5c.7 1.7.2 2.9.1 3.3.8.9 1.3 2 1.3 3.3 0 4.7-2.9 5.8-5.6 6.1.4.4.8 1.1.8 2.3v3.4c0 .3.2.7.8.6 4.9-1.6 8.4-6.2 8.4-11.7C24.8 5.9 19.3.4 12.5.4"/></svg></a></li><li class="twitter-icon"><a href="https://twitter.com/narwhalnellie" aria-label="Follow sonarwhal on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 25 24"><path class="twitter-icon-svg" d="M25 4.4c-.9.4-1.9.7-2.9.8 1-.6 1.8-1.6 2.2-2.8-1 .6-2.1 1-3.2 1.2-.9-1-2.2-1.6-3.7-1.6-2.8 0-5 2.3-5 5 0 .4 0 .8.1 1.2C8.3 8 4.6 6 2.1 2.9c-.4.8-.7 1.6-.7 2.6 0 1.8.9 3.3 2.2 4.2-.8-.1-1.5-.3-2.2-.7v.1c0 2.4 1.7 4.5 4.1 5-.4.1-.9.2-1.3.2-.3 0-.6 0-.9-.1.6 2 2.5 3.5 4.7 3.5-1.9 1.3-4 2.1-6.4 2.1-.4 0-.8 0-1.2-.1C2.6 21.2 5.3 22 8.1 22c9.3 0 14.4-7.7 14.4-14.4v-.7c1-.6 1.8-1.5 2.5-2.5"/></svg></a></li><li class="medium-icon"><a href="https://medium.com/sonarwhal" aria-label="Follow sonarwhal on Medium"><svg xmlns="http://www.w3.org/2000/svg" viewbox="4 2 40 40"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.7-.32 1.03l-2.45 3v.38h6.9v-.4l-2.4-2.98c-.3-.34-.35-.5-.35-1.03v-8.95l6.13 13.36h.7L27 18.42v10.64c0 .3 0 .35-.2.53L25 31.4v.37h9.2v-.4l-1.82-1.8c-.2-.17-.22-.23-.22-.52v-13.1c0-.3.03-.36.2-.54l1.83-1.8v-.32h-6.5L23.1 24.8l-5.2-11.55h-6.8v.4l2.14 2.63c.24.3.3.37.3.77V27.4z" class="medium-icon-svg"/></svg></a></li></ul></div></footer><script src="/static/scripts/treeview-e14923d6bd.js" integrity="sha384-f4cDTA+aFtC3QxumypR+xrziAyyNLALeZLCcS4ZXdc/O93x/9Xyk/IzcUOmkNBDY" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" integrity="sha384-bpcisN7hXHzDmg5JLgtPet7fpev9Wwwqgw8zlXpOh7AkvJ+wYjwrMzHH8fVvq1Dq" crossorigin="anonymous"></script><script src="/static/scripts/common-234f1d98cc.js" integrity="sha384-uQNhTpxyfsvKX1WnECKzm/7fYOFRWjGPmomV8W31O1ZNYBQWBcYpjjO4OqmpZ4M6" crossorigin="anonymous"></script><script>!function(){var e,t=docsearch({apiKey:"2ee58f908e6d720c4f72a9645ce0e857",indexName:"sonarwhal",inputSelector:"#search-input",appId:"0R8E5SPAFP",debug:!1,handleSelected:function(t,o,n){window.innerWidth<e?o.target.closest("form").submit():window.location.href=n.url}}),o=document.querySelector(".algolia-autocomplete .ds-dropdown-menu");e=parseInt(window.getComputedStyle(o).minWidth),t.autocomplete.on("autocomplete:opened",function(){document.body.clientWidth<e&&t.autocomplete.autocomplete.close()})}()</script><script src="/sw-reg.js" integrity="sha384-gRovFrJVkjTNXoDUATy5auNPBtLX1kLAiFPr0Y0558FvYta2yNWP955eXf8tv0KU" crossorigin="anonymous"></script><script>!function(e,a,t,c,g){e.GoogleAnalyticsObject="ga",e.ga||(e.ga=function(){(e.ga.q=e.ga.q||[]).push(arguments)}),e.ga.l=+new Date,c=a.createElement("script"),g=a.scripts[0],c.src="https://www.google-analytics.com/analytics.js",g.parentNode.insertBefore(c,g)}(this,document),ga("create","UA-101540923-1"),ga("send","pageview")</script></body></html>